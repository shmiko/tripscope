{"version":3,"file":"/packages/telescope-update-prompt.js","sources":["telescope-update-prompt/lib/client/update.js","telescope-update-prompt/lib/client/templates/update_banner.html","telescope-update-prompt/lib/client/templates/update_banner.js"],"names":[],"mappings":";;;;;;;;AAAA,2E;AACA,8B;AACA,8B;AACA,wE;AACA,yD;AACA,gD;AACA,kC;AACA,K;AACA,e;AACA,C;;AAEA,4B;AACA,qC;;AAEA,qD;AACA,yB;AACA,0B;AACA,e;AACA,4C;AACA,sC;AACA,uB;AACA,uD;AACA,iD;AACA,O;AACA,K;AACA,K;AACA,G;;AAEA,kB;AACA,0B;AACA,G;;;;;;;;;;;;;;;;;;;AC7BA,qC;AACA,8E;AACA,kB;AACA,8B;AACA,qD;AACA,iB;AACA,iC;AACA,+C;AACA,4B;AACA,+B;AACA,8B;AACA,wD;AACA,+B;AACA,+B;AACA,8B;AACA,8B;AACA,0E;AACA,+B;AACA,wD;AACA,+D;AACA,kF;AACA,8E;AACA,sB;AACA,qD;AACA,6C;AACA,sB;AACA,sF;AACA,K;AACA,I;;;;;;;;;;;;;;;;;;;AC7BA,+C;AACA,2B;AACA,wC;AACA,I;AACA,wB;AACA,wC;AACA,I;AACA,+B;AACA,4B;AACA,I;AACA,wB;AACA,wC;AACA,G;AACA,G","sourcesContent":["compareVersions = function (v1, v2) { // return true if v2 is newer than v1\n  var v1Array = v1.split('.');\n  var v2Array = v2.split('.');\n  // go through each segment of v2 and stop if we find one that's higher\n  // than the equivalent segment of v1; else return false\n  return v2Array.some( function (value, index) {\n    return value > v1Array[index];\n  });\n  return false;\n}\n\nMeteor.startup(function () {\n  Session.set('updateVersion', null);\n\n  Meteor.call('phoneHome', function (error, result) {\n    // console.log(error)\n    // console.log(result)\n    if(result){\n      var currentVersion = telescopeVersion;\n      var newVersion = result.content;\n      var message = \"\";\n      if (compareVersions(currentVersion, newVersion)){\n        Session.set('updateVersion', newVersion);\n      }\n    }\n  });\n});\n\nheroModules.push({\n  template: 'updateBanner'\n});","\nTemplate.__checkName(\"updateBanner\");\nTemplate[\"updateBanner\"] = new Template(\"Template.updateBanner\", (function() {\n  var view = this;\n  return Blaze.If(function() {\n    return Spacebars.call(view.lookup(\"showBanner\"));\n  }, function() {\n    return [ \"\\n    \", HTML.DIV({\n      \"class\": \"update-banner grid-module grid\"\n    }, \"\\n      \", HTML.H3({\n      \"class\": \"update-version\"\n    }, Blaze.View(function() {\n      return Spacebars.mustache(view.lookup(\"version\"));\n    })), \"\\n      \", HTML.DIV({\n      \"class\": \"update-content\"\n    }, \"\\n        \", HTML.H4({\n      \"class\": \"update-prompt\"\n    }, \"A new version of Telescope is available.\"), \"\\n        \", HTML.P({\n      \"class\": \"update-message\"\n    }, \"\\n          You have: \", Blaze.View(function() {\n      return Spacebars.mustache(view.lookup(\"currentVersion\"));\n    }), \". Note: this message is only displayed to admins. \\n          \", HTML.A({\n      href: \"https://github.com/TelescopeJS/Telescope/blob/master/History.md\",\n      target: \"_blank\"\n    }, \"View changelog\"), \" | \\n          \", HTML.A({\n      href: \"http://telesc.pe/docs/updating\",\n      target: \"_blank\"\n    }, \"View update instructions\"), \"\\n          \"), \"\\n      \"), \"\\n    \"), \"\\n  \" ];\n  });\n}));\n","Template[getTemplate('updateBanner')].helpers({\n  showBanner: function () {\n    return Session.get('updateVersion');\n  },\n  version: function () {\n    return Session.get('updateVersion');\n  },\n  currentVersion: function () {\n    return telescopeVersion;\n  },\n  message: function () {\n    return Session.get('updateMessage');\n  }\n});"]}